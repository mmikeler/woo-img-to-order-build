(this["webpackJsonpwoo-image-to-order"]=this["webpackJsonpwoo-image-to-order"]||[]).push([[0],{23:function(e,t,n){},24:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),c=n(17),s=n.n(c),r=(n(23),n(24),n(0));function o(){return Object(r.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",children:Object(r.jsx)("div",{className:"container-fluid",children:Object(r.jsx)("a",{className:"navbar-brand",href:"#",children:"Navbar"})})})}var l=n(2),d=n(4),j=n(8),p=n.n(j),h=n(3),u=n.n(h),m=n(5),b=n(9),f=n(10),x=n(6),O=n(13),v=n(11),g=n(7),w=n.n(g);a.PureComponent,n(16);function y(){return Object(r.jsxs)("svg",{className:"loader",version:"1.1",id:"L9",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 30 30",enableBackground:"new 0 0 0 0",children:[Object(r.jsx)("rect",{x:"0",y:"0",width:"4",height:"10",fill:"#fff",children:Object(r.jsx)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0",dur:"0.6s",repeatCount:"indefinite"})}),Object(r.jsx)("rect",{x:"10",y:"0",width:"4",height:"10",fill:"#f0a",children:Object(r.jsx)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.2s",dur:"0.6s",repeatCount:"indefinite"})}),Object(r.jsx)("rect",{x:"20",y:"0",width:"4",height:"10",fill:"#fff",children:Object(r.jsx)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.4s",dur:"0.6s",repeatCount:"indefinite"})})]})}function N(e){var t=Object(a.useContext)(E),n=t.state,i=t.dispatch,c=n.files[e.index],s=Object(a.useRef)(null),o=Object(a.useState)(null),l=Object(d.a)(o,2),j=l[0],p=l[1],h=Object(a.useState)({unit:"px",width:0,height:0,aspect:10/15,x:0,y:0}),b=Object(d.a)(h,2),f=b[0],x=b[1],O=Object(a.useState)(!0),v=Object(d.a)(O,2),g=v[0],N=v[1],C=Object(a.useCallback)((function(t){var a=t.target;s.current=a;var i=[n.files[e.index].options.aspect,a.width,a.height,f.x,f.y],c=i[0],r=i[1],o=i[2],l=i[3],d=i[4];return c>1?(o=r/c,l=0,d=(a.height-o)/2):(r=o*c,l=(a.width-r)/2,d=0),x({unit:"px",aspect:c,width:r,height:o,x:l,y:d}),N(!1),!1}),[]),k=function(){var t=Object(m.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s&&n.width&&n.height&&(N(!0),I(s.current,n,"newFile.jpeg").then((function(t){var n=c.options;n.preCrop=t,i({type:"updateOptions",payload:{index:e.index,options:n}})})),setTimeout((function(){N(!1)}),1500));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=function(e,t,n){var a=document.createElement("canvas"),i=window.devicePixelRatio,c=e.naturalWidth/e.width,s=e.naturalHeight/e.height,r=a.getContext("2d");return a.width=t.width*i*c,a.height=t.height*i*s,r.setTransform(i,0,0,i,0,0),r.imageSmoothingQuality="high",r.drawImage(e,t.x*c,t.y*s,t.width*c,t.height*s,0,0,t.width*c,t.height*s),new Promise((function(e,t){a.toBlob((function(e){var t=window.URL.createObjectURL(e);p(t),window.URL.revokeObjectURL(t)}),"image/png",1),e(j)}))};return Object(a.useEffect)((function(){if(f.aspect!==n.files[e.index].options.aspect){var t=s.current,a=[n.files[e.index].options.aspect,t.width,t.height,f.x,f.y],i=a[0],c=a[1],r=a[2],o=a[3],l=a[4];i>1?(r=c/i,o=0,l=(t.height-r)/2):(c=r*i,o=(t.width-c)/2,l=0),x({unit:"px",aspect:i,width:c,height:r,x:o,y:l})}}),[n,f,s,e.index]),Object(r.jsxs)(r.Fragment,{children:[g&&Object(r.jsx)(y,{}),Object(r.jsx)(w.a,{crop:f,disabled:g,onChange:function(e){return x(e)},onComplete:function(e){k(e)},onDragEnd:function(){return N(!0)},renderComponent:s?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"overlay","is-loaded":s.current?1:0,children:Object(r.jsx)(y,{})}),Object(r.jsx)("img",{src:c.body,onLoadStart:function(){return N(!0)},onLoad:C,ref:s,className:"ReactCrop__image",alt:""})]}):null})]})}function C(e){var t=Object(a.useContext)(E),n=t.state,i=t.dispatch,c=n.files[e.index].options,s=function(e,t){var n=e.split("x");return n[1]/n[0]===t?n[0]/n[1]:n[1]/n[0]};return void 0===c?null:Object(r.jsxs)("div",{onClick:function(){n.changeMod&&(c.changed=!c.changed,i({type:"updateOptions",payload:{index:e.index,options:c}}))},className:"file d-flex",changed:c.changed?"changed":"",children:[Object(r.jsx)(N,{index:e.index}),Object(r.jsxs)("div",{className:"file-options",children:[Object(r.jsxs)("div",{className:"o format",children:[Object(r.jsx)(p.a,{name:"lni lni-ruler-alt"}),"\xa0",c.format?c.format:"\u041d\u0435\u0442"]}),Object(r.jsxs)("div",{className:"o paper",children:[Object(r.jsx)(p.a,{name:"lni lni-write"}),"\xa0",c.paper?c.paper:"\u041d\u0435\u0442"]}),Object(r.jsxs)("div",{className:"o crop",children:[Object(r.jsx)(p.a,{name:"lni lni-crop"}),"\xa0",c.cadr?c.cadr:"\u041d\u0435\u0442"]}),Object(r.jsxs)("div",{className:"o count",children:[Object(r.jsx)(p.a,{name:"lni lni-shopping-basket"}),"\xa0",c.count?c.count:"\u041d\u0435\u0442"]}),Object(r.jsx)("div",{className:"delimeter"}),Object(r.jsx)(k,{index:e.index,remove:e.remove,rotate:function(){c.aspect=s(c.format,c.aspect),i({type:"updateOptions",payload:{index:e.index,options:c}})}})]})]})}function k(e){var t=Object(a.useContext)(E),n=(t.state,t.dispatch);return Object(r.jsxs)("div",{className:"item-option-list",children:[Object(r.jsx)(I,{actionFunction:e.rotate,iconClass:"lni lni-spinner-arrow",itemClass:"rotate",index:e.index}),Object(r.jsx)(I,{actionFunction:function(){return n({type:"remove",payload:e.index})},iconClass:"lni lni-close",itemClass:"close",index:e.index})]})}function I(e){var t=Object(l.a)({},e),n=t.actionFunction,a=t.iconClass,i=t.itemClass;return Object(r.jsx)("div",{onClick:n,className:"item-option ".concat(i),children:Object(r.jsx)(p.a,{name:a})})}var M=function(){var e=Object(a.useContext)(E),t=e.state;return e.dispatch,function(){var e=t.files.map((function(e,t){if(e)return Object(r.jsx)(C,{index:t},e.id)}));return e.length<=0&&(e="\u043d\u0435\u0442 \u0444\u043e\u0442\u043e"),Object(r.jsx)("div",{className:"list mt-3","change-mod":t.changeMod?1:0,children:e})}()},S=n(18);function L(e){var t=Object(a.useContext)(E),n=(t.state,t.dispatch),i=Object(a.useRef)();return e.mod?Object(r.jsx)("div",{className:"file-options-form-wrapper",children:Object(r.jsx)("div",{className:"card border-secondary file-options-form",children:Object(r.jsxs)("form",{ref:i,children:[Object(r.jsx)("div",{className:"card-header",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),Object(r.jsxs)("div",{className:"card-body",children:[Object(r.jsx)(R,{}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{forhtml:"exampleSelect1",className:"form-label mt-4",children:"\u0424\u043e\u0440\u043c\u0430\u0442 \u0444\u043e\u0442\u043e"}),Object(r.jsxs)("select",{className:"form-select",name:"format",id:"exampleSelect1",required:!0,children:[Object(r.jsx)("option",{disabled:!0,children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"}),Object(r.jsx)("option",{value:"10x15",children:"10x15"}),Object(r.jsx)("option",{value:"15x20",children:"15x20"}),Object(r.jsx)("option",{value:"20x30",children:"20x30"})]})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{forhtml:"exampleSelect2",className:"form-label mt-4",children:"\u0422\u0438\u043f \u0431\u0443\u043c\u0430\u0433\u0438"}),Object(r.jsxs)("select",{className:"form-select",name:"paper",id:"exampleSelect2",required:!0,children:[Object(r.jsx)("option",{disabled:!0,children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"}),Object(r.jsx)("option",{value:"\u043c\u0430\u0442\u043e\u0432\u0430\u044f",children:"\u041c\u0430\u0442\u043e\u0432\u0430\u044f"}),Object(r.jsx)("option",{value:"\u0433\u043b\u044f\u043d\u0435\u0446",children:"\u0413\u043b\u044f\u043d\u0435\u0446"})]})]}),Object(r.jsx)("div",{className:"form-group mt-3",children:Object(r.jsxs)("div",{className:"form-check form-switch",children:[Object(r.jsx)("input",{className:"form-check-input",name:"cadr",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"}),Object(r.jsx)("label",{className:"form-check-label",forhtml:"flexSwitchCheckDefault",children:"\u041a\u0430\u0434\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"})]})}),Object(r.jsxs)("div",{className:"mt-3",children:[Object(r.jsx)("label",{forhtml:"exampleFormControlInput3",className:"form-label",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(r.jsx)("input",{type:"number",name:"count",className:"form-control",id:"exampleFormControlInput3",defaultValue:"1"})]})]}),Object(r.jsx)("div",{className:"card-footer d-flex justify-content-end",children:Object(r.jsx)("div",{onClick:function(e){var t,a=e.target.closest("form"),i=new FormData(a),c=[],s=Object(S.a)(i);try{for(s.s();!(t=s.n()).done;){var r=Object(d.a)(t.value,2),o=r[0],l=r[1];c.push({name:o,value:l})}}catch(j){s.e(j)}finally{s.f()}n({type:"massSetFilesOptions",payload:c})},className:"btn btn-success",children:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})})]})})}):null}function R(e){var t=Object(a.useContext)(E),n=t.state,i=(t.dispatch,null);return n.files&&(i=n.files.map((function(e){return!(void 0===e.options||!e.options.changed)&&Object(r.jsx)("div",{className:"changed-files-list-item",style:{backgroundImage:"url(".concat(window.URL.createObjectURL(e.file),")")}},e.id)}))).length>0?Object(r.jsx)("div",{className:"changed-file-list",children:i}):null}var F=function(e){Object(O.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this,e)).onImageLoaded=function(e){a.imageRef=e},a.onCropComplete=function(e){a.makeClientCrop(e)},a.onCropChange=function(e,t){a.setState({crop:e})},a.state={src:"",crop:{unit:"%",width:"100",aspect:2/3}},a.save=a.save.bind(Object(x.a)(a)),a}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.file,t=e.options.cropped?e.options.cropped:window.URL.createObjectURL(this.props.file.file);this.setState({src:t})}},{key:"componentWillUnmount",value:function(){var e=this.props.file,t=e.options.cropped?e.options.cropped:window.URL.createObjectURL(this.props.file.file);this.setState({src:t})}},{key:"makeClientCrop",value:function(){var e=Object(m.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.imageRef&&t.width&&t.height)){e.next=5;break}return e.next=3,this.getCroppedImg(this.imageRef,t,"newFile.jpeg");case 3:n=e.sent,this.setState({croppedImageUrl:n});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCroppedImg",value:function(e,t,n){var a=this,i=document.createElement("canvas"),c=window.devicePixelRatio,s=e.naturalWidth/e.width,r=e.naturalHeight/e.height,o=i.getContext("2d");return i.width=t.width*c*s,i.height=t.height*c*r,o.setTransform(c,0,0,c,0,0),o.imageSmoothingQuality="high",o.drawImage(e,t.x*s,t.y*r,t.width*s,t.height*r,0,0,t.width*s,t.height*r),new Promise((function(e,t){a.fileUrl=i.toDataURL(),e(a.fileUrl)}))}},{key:"close",value:function(){this.props.setSetupImageMod(null)}},{key:"save",value:function(){var e=this.state.croppedImageUrl,t=this.props.fileIndex;this.props.upd("cropped",e,t),this.setState({src:e})}},{key:"render",value:function(){var e=this,t=this.state,n=t.crop,a=t.src,i=t.croppedImageUrl,c=this.props,s=c.fileIndex,o=c.file;return Object(r.jsx)("div",{className:"modal fade show",id:"file-direction",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"false",children:Object(r.jsx)("div",{className:"modal-dialog",role:"document",children:Object(r.jsxs)("div",{className:"modal-content",children:[Object(r.jsxs)("div",{className:"modal-header",children:[Object(r.jsx)("h5",{className:"modal-title",id:"file-direction-label",children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u043c"}),Object(r.jsx)("button",{onClick:this.props.closeModal,type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(r.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(r.jsx)("div",{className:"modal-body",children:Object(r.jsx)("div",{className:"container-fluid",children:Object(r.jsxs)("div",{className:"row",children:[Object(r.jsx)("div",{className:"col-md-8 react-crop-wrapper-row",children:Object(r.jsx)("div",{className:"react-crop-wrapper",children:a&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"item-option-list",children:[Object(r.jsx)(I,{actionFunction:function(){return e.props.upd("rotate",!o.options.rotate,s)},iconClass:"lni lni-ruler-alt",itemClass:"rotate",index:this.props.fileIndex}),Object(r.jsx)(I,{actionFunction:function(){return e.props.upd("rotate",!o.options.rotate,s)},iconClass:"lni lni-spinner-arrow",itemClass:"rotate",index:this.props.fileIndex})]}),Object(r.jsx)(w.a,{src:a,crop:n,ruleOfThirds:!0,onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange})]})})}),Object(r.jsx)("div",{className:"col-md-4 react-crop-options-bar",children:a&&Object(r.jsxs)("div",{className:"file-direction__crop",children:[Object(r.jsx)("span",{children:"\u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"}),Object(r.jsx)("img",{src:i,alt:""})]})})]})})}),Object(r.jsxs)("div",{className:"modal-footer",children:[Object(r.jsx)("button",{onClick:this.props.closeModal,type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),Object(r.jsx)("button",{onClick:this.save,type:"button",className:"btn btn-primary",children:"\u041e\u0431\u0440\u0435\u0437\u0430\u0442\u044c"})]})]})})})}}]),n}(a.PureComponent);function U(e,t){var n,a=e.files;switch(t.type){case"add":for(var i=t.payload,c=[],s=0;s<i.length;s++){var r={id:T(n=i[s]),file:n,body:URL.createObjectURL(n),options:{count:1,format:"10x15",paper:"\u043c\u0430\u0442\u043e\u0432\u0430\u044f",cadr:0,rotate:!1,changed:!0,cropped:[],aspect:10/15}};c.push(r)}return Object(l.a)(Object(l.a)({},e),{},{files:a.concat(c),changeMod:!0});case"remove":return a.splice(t.payload,1,null),Object(l.a)(Object(l.a)({},e),{},{files:a});case"updateOptions":return a[t.payload.index].options=t.payload.options,Object(l.a)(Object(l.a)({},e),{},{files:a});case"rotate":var o=a[t.payload].options.rotate;return a[t.payload].options.rotate=!o,Object(l.a)(Object(l.a)({},e),{},{files:a});case"crop":return a[t.payload].options.cropped.push(a[t.payload].options.preCrop),Object(l.a)(Object(l.a)({},e),{},{files:a});case"setChangingMod":var d=e.files;return e.changeMod&&d.forEach((function(e){e.options.changed=!1})),Object(l.a)(Object(l.a)({},e),{},{files:d,changeMod:!e.changeMod});case"massSetFilesOptions":var j=t.payload;return e.files.forEach((function(e){e.options.changed&&(j.forEach((function(t){e.options[t.name]=t.value})),j.findIndex((function(e){return"cadr"===e.name}))<0&&(e.options.cadr=!1))})),Object(l.a)(Object(l.a)({},e),{},{files:e.files});default:throw new Error}}function T(e){return e.size+"_"+e.name}var E=Object(a.createContext)(null);function P(){var e=Object(a.useReducer)(U,{files:[],changeMod:!1,setupImageMod:null,lastModifiedTime:(new Date).getTime()}),t=Object(d.a)(e,2),n=t[0],i=t[1];return Object(r.jsxs)(E.Provider,{value:{state:n,dispatch:i},children:[Object(r.jsx)(D,{}),"number"===typeof setupImageMod&&Object(r.jsx)(F,{fileIndex:n.setupImageMod,file:n.files[n.setupImageMod],closeModal:function(){}})]})}function D(e){var t=Object(a.useContext)(E),n=t.state,i=t.dispatch;return Object(r.jsxs)("div",{className:"row",children:[Object(r.jsx)("div",{className:"col-12 col-lg-10",children:Object(r.jsxs)("div",{className:"card border-secondary my-3",children:[Object(r.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:["\u0412\u0430\u0448\u0438 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438: ",n.files.length,Object(r.jsx)(B,{modOn:n.changeMod,setChangingMod:n.setChangingMod})]}),Object(r.jsx)("div",{className:"card-body",children:Object(r.jsxs)("div",{className:"image-list",children:[Object(r.jsxs)("label",{children:[Object(r.jsx)("span",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e"}),Object(r.jsx)("input",{onChange:function(e){i({type:"add",payload:e.target.files})},className:"form-control",type:"file",multiple:!0})]}),Object(r.jsx)(M,{})]})}),Object(r.jsx)("div",{className:"card-footer d-flex justify-content-end",children:Object(r.jsx)("div",{className:"btn btn-success disabled",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044e \u0437\u0430\u043a\u0430\u0437\u0430"})})]})}),Object(r.jsx)("div",{className:"col-12 col-lg-2",children:Object(r.jsx)(L,Object(l.a)({mod:!0,massSetOptions:n.massSetOptions},e))})]})}function B(e){var t=Object(a.useContext)(E),n=t.state,i=t.dispatch,c="\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e";n.changeMod&&(c="\u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c");return Object(r.jsx)("div",{onClick:function(){i({type:"setChangingMod"})},className:"btn btn-info text-white",children:c})}var _=function(){return Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)(o,{}),Object(r.jsx)(P,{})]})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),c(e),s(e)}))};s.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(_,{})}),document.getElementById("root")),W()}},[[38,1,2]]]);
//# sourceMappingURL=main.96b9c711.chunk.js.map