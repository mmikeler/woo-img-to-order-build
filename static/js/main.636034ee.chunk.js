(this["webpackJsonpwoo-image-to-order"]=this["webpackJsonpwoo-image-to-order"]||[]).push([[0],{22:function(e,t,n){},23:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),s=n(16),c=n.n(s),o=(n(22),n(23),n(0));function r(){return Object(o.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",children:Object(o.jsx)("div",{className:"container-fluid",children:Object(o.jsx)("a",{className:"navbar-brand",href:"#",children:"Navbar"})})})}var l=n(11),d=n(10),p=n(4),h=n.n(p),u=n(2),m=n.n(u),j=n(5),f=n(6),b=n(7),x=n(3),v=n(13),O=n(9),g=n(8),C=n.n(g),w=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(f.a)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={src:"",image:{width:0,height:0},crop:{unit:"%",width:"100",aspect:10/15,x:0,y:0}},e.save=e.save.bind(Object(x.a)(e)),e.onImageLoaded=function(t){e.imageRef=t,e.imageTo64(t),e.setState({image:{width:t.width,height:t.height}}),e.createCROP()},e.onCropComplete=function(t){e.makeClientCrop(t)},e.onCropChange=function(t,n){e.setState({crop:t})},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.file,t=e.options.cropped.length>0?e.options.cropped[e.options.cropped.length-1]:window.URL.createObjectURL(this.props.file.file);this.setState({src:t})}},{key:"componentDidUpdate",value:function(){this.createCROP()}},{key:"componentWillUnmount",value:function(){var e=this.props.file,t=e.options.cropped?e.options.cropped:window.URL.createObjectURL(this.props.file.file);this.setState({src:t})}},{key:"createCROP",value:function(){var e=[this.props.file.options.aspect,this.state.image.width,this.state.image.height],t=e[0],n=e[1],i=e[2],a=this.state.crop;void 0!==t&&t!==a.aspect&&(t>1?i=n/t:n=i*t,a={unit:"px",aspect:t,width:n,height:i,x:0,y:0},this.setState({crop:a}))}},{key:"makeClientCrop",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.imageRef&&t.width&&t.height)){e.next=8;break}return e.next=3,this.getCroppedImg(this.imageRef,t,"newFile.jpeg");case 3:n=e.sent,this.setState({croppedImageUrl:n}),(i=this.props.file.options).preCrop=n,this.props.d({type:"updateOptions",payload:{index:this.props.index,options:i}});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"imageTo64",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return n=this.props.s.files[this.props.index].options,e.next=4,this.getImage(t);case 4:i=e.sent,n.cropped.push(i),this.props.d({type:"updateOptions",payload:{index:this.props.index,options:n}}),this.setState({src:i});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getImage",value:function(e){var t=this,n=document.createElement("canvas"),i=window.devicePixelRatio,a=e.naturalWidth,s=e.naturalHeight,c=n.getContext("2d");return n.width=i*a,n.height=i*s,c.setTransform(i,0,0,i,0,0),c.imageSmoothingQuality="high",c.drawImage(e,0,0,a,s),new Promise((function(e,i){t.fileUrl=n.toDataURL(),e(t.fileUrl)}))}},{key:"getCroppedImg",value:function(e,t,n){var i=this,a=document.createElement("canvas"),s=window.devicePixelRatio,c=e.naturalWidth/e.width,o=e.naturalHeight/e.height,r=a.getContext("2d");return a.width=t.width*s*c,a.height=t.height*s*o,r.setTransform(s,0,0,s,0,0),r.imageSmoothingQuality="high",r.drawImage(e,t.x*c,t.y*o,t.width*c,t.height*o,0,0,t.width*c,t.height*o),new Promise((function(e,t){i.fileUrl=a.toDataURL(),e(i.fileUrl)}))}},{key:"save",value:function(){var e=this.state.croppedImageUrl,t=this.props.fileIndex;this.props.upd("cropped",e,t),this.setState({src:e})}},{key:"render",value:function(){var e=this.state,t=e.crop,n=(e.croppedImageUrl,this.props),i=(n.fileIndex,n.file),a=i.options.cropped.length>0?i.options.cropped[i.options.cropped.length-1]:this.state.src;return Object(o.jsx)(o.Fragment,{children:Object(o.jsx)(C.a,{src:a,crop:t,rotate:0,ruleOfThirds:!0,onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange},this.props.aspect)})}}]),n}(i.PureComponent);function y(e){var t=Object(i.useContext)(P),n=t.state,a=t.dispatch,s=n.files[e.index],c=s.options,r=function(e,t){var n=e.split("x");return n[1]/n[0]===t?n[0]/n[1]:n[1]/n[0]};return void 0===c?null:Object(o.jsxs)("div",{onClick:function(){e.changeMod&&e.upd("changed",!c.changed,e.index)},className:"file d-flex",changed:c.changed?"changed":"",children:[Object(o.jsx)(w,{s:n,d:a,file:s,aspect:c.aspect,index:e.index}),Object(o.jsxs)("div",{className:"file-options",children:[Object(o.jsxs)("div",{className:"o format",children:[Object(o.jsx)(h.a,{name:"lni lni-ruler-alt"}),"\xa0",c.format?c.format:"\u041d\u0435\u0442"]}),Object(o.jsxs)("div",{className:"o paper",children:[Object(o.jsx)(h.a,{name:"lni lni-write"}),"\xa0",c.paper?c.paper:"\u041d\u0435\u0442"]}),Object(o.jsxs)("div",{className:"o crop",children:[Object(o.jsx)(h.a,{name:"lni lni-crop"}),"\xa0",c.cadr?c.cadr:"\u041d\u0435\u0442"]}),Object(o.jsxs)("div",{className:"o count",children:[Object(o.jsx)(h.a,{name:"lni lni-shopping-basket"}),"\xa0",c.count?c.count:"\u041d\u0435\u0442"]}),Object(o.jsx)("div",{className:"delimeter"}),Object(o.jsx)(N,{index:e.index,crop:function(){},remove:e.remove,rotate:function(){c.aspect=r(c.format,c.aspect),a({type:"updateOptions",payload:{index:e.index,options:c}})}})]})]})}function N(e){var t=Object(i.useContext)(P),n=(t.state,t.dispatch);return Object(o.jsxs)("div",{className:"item-option-list",children:[Object(o.jsx)(k,{actionFunction:function(){return n({type:"crop",payload:e.index})},iconClass:"lni lni-crop",itemClass:"crop",index:e.index}),Object(o.jsx)(k,{actionFunction:e.rotate,iconClass:"lni lni-spinner-arrow",itemClass:"rotate",index:e.index}),Object(o.jsx)(k,{actionFunction:function(){return n({type:"remove",payload:e.index})},iconClass:"lni lni-close",itemClass:"close",index:e.index})]})}function k(e){var t=Object(l.a)({},e),n=t.actionFunction,i=t.iconClass,a=t.itemClass;return Object(o.jsx)("div",{onClick:n,className:"item-option ".concat(a),children:Object(o.jsx)(h.a,{name:i})})}var I=function(){var e=Object(i.useContext)(P),t=e.state;return e.dispatch,function(){var e=t.files.map((function(e,t){if(e)return Object(o.jsx)(y,{index:t},e.id)}));return e.length<=0&&(e="\u043d\u0435\u0442 \u0444\u043e\u0442\u043e"),Object(o.jsx)("div",{className:"list mt-3","change-mod":t.changeMod?1:0,children:e})}()},S=n(17);function U(e){var t=Object(i.useRef)();return e.mod?Object(o.jsx)("div",{className:"file-options-form-wrapper",children:Object(o.jsx)("div",{className:"card border-secondary file-options-form",children:Object(o.jsxs)("form",{ref:t,children:[Object(o.jsx)("div",{className:"card-header",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)(R,{files:e.files}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{forhtml:"exampleSelect1",className:"form-label mt-4",children:"\u0424\u043e\u0440\u043c\u0430\u0442 \u0444\u043e\u0442\u043e"}),Object(o.jsxs)("select",{className:"form-select",name:"format",id:"exampleSelect1",required:!0,children:[Object(o.jsx)("option",{disabled:!0,children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"}),Object(o.jsx)("option",{value:"10x15",children:"10x15"}),Object(o.jsx)("option",{value:"15x20",children:"15x20"}),Object(o.jsx)("option",{value:"20x30",children:"20x30"})]})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{forhtml:"exampleSelect2",className:"form-label mt-4",children:"\u0422\u0438\u043f \u0431\u0443\u043c\u0430\u0433\u0438"}),Object(o.jsxs)("select",{className:"form-select",name:"paper",id:"exampleSelect2",required:!0,children:[Object(o.jsx)("option",{disabled:!0,children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"}),Object(o.jsx)("option",{value:"\u043c\u0430\u0442\u043e\u0432\u0430\u044f",children:"\u041c\u0430\u0442\u043e\u0432\u0430\u044f"}),Object(o.jsx)("option",{value:"\u0433\u043b\u044f\u043d\u0435\u0446",children:"\u0413\u043b\u044f\u043d\u0435\u0446"})]})]}),Object(o.jsx)("div",{className:"form-group mt-3",children:Object(o.jsxs)("div",{className:"form-check form-switch",children:[Object(o.jsx)("input",{className:"form-check-input",name:"cadr",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"}),Object(o.jsx)("label",{className:"form-check-label",forhtml:"flexSwitchCheckDefault",children:"\u041a\u0430\u0434\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"})]})}),Object(o.jsxs)("div",{className:"mt-3",children:[Object(o.jsx)("label",{forhtml:"exampleFormControlInput3",className:"form-label",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(o.jsx)("input",{type:"number",name:"count",className:"form-control",id:"exampleFormControlInput3",defaultValue:"1"})]})]}),Object(o.jsx)("div",{className:"card-footer d-flex justify-content-end",children:Object(o.jsx)("div",{onClick:function(t){var n,i=t.target.closest("form"),a=new FormData(i),s=[],c=Object(S.a)(a);try{for(c.s();!(n=c.n()).done;){var o=Object(d.a)(n.value,2),r=o[0],l=o[1];s.push({name:r,value:l})}}catch(p){c.e(p)}finally{c.f()}e.massSetOptions(s)},className:"btn btn-success",children:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})})]})})}):null}function R(e){var t=null;return e.files&&(t=e.files.map((function(e){return!(void 0===e.options||!e.options.changed)&&Object(o.jsx)("div",{className:"changed-files-list-item",style:{backgroundImage:"url(".concat(window.URL.createObjectURL(e.file),")")}},e.id)}))).length>0?Object(o.jsx)("div",{className:"changed-file-list",children:t}):null}n(37);var L=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e){var i;return Object(f.a)(this,n),(i=t.call(this,e)).onImageLoaded=function(e){i.imageRef=e},i.onCropComplete=function(e){i.makeClientCrop(e)},i.onCropChange=function(e,t){i.setState({crop:e})},i.state={src:"",crop:{unit:"%",width:"100",aspect:2/3}},i.save=i.save.bind(Object(x.a)(i)),i}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.file,t=e.options.cropped?e.options.cropped:window.URL.createObjectURL(this.props.file.file);this.setState({src:t})}},{key:"componentWillUnmount",value:function(){var e=this.props.file,t=e.options.cropped?e.options.cropped:window.URL.createObjectURL(this.props.file.file);this.setState({src:t})}},{key:"makeClientCrop",value:function(){var e=Object(j.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.imageRef&&t.width&&t.height)){e.next=5;break}return e.next=3,this.getCroppedImg(this.imageRef,t,"newFile.jpeg");case 3:n=e.sent,this.setState({croppedImageUrl:n});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCroppedImg",value:function(e,t,n){var i=this,a=document.createElement("canvas"),s=window.devicePixelRatio,c=e.naturalWidth/e.width,o=e.naturalHeight/e.height,r=a.getContext("2d");return a.width=t.width*s*c,a.height=t.height*s*o,r.setTransform(s,0,0,s,0,0),r.imageSmoothingQuality="high",r.drawImage(e,t.x*c,t.y*o,t.width*c,t.height*o,0,0,t.width*c,t.height*o),new Promise((function(e,t){i.fileUrl=a.toDataURL(),e(i.fileUrl)}))}},{key:"close",value:function(){this.props.setSetupImageMod(null)}},{key:"save",value:function(){var e=this.state.croppedImageUrl,t=this.props.fileIndex;this.props.upd("cropped",e,t),this.setState({src:e})}},{key:"render",value:function(){var e=this,t=this.state,n=t.crop,i=t.src,a=t.croppedImageUrl,s=this.props,c=s.fileIndex,r=s.file;return Object(o.jsx)("div",{className:"modal fade show",id:"file-direction",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"false",children:Object(o.jsx)("div",{className:"modal-dialog",role:"document",children:Object(o.jsxs)("div",{className:"modal-content",children:[Object(o.jsxs)("div",{className:"modal-header",children:[Object(o.jsx)("h5",{className:"modal-title",id:"file-direction-label",children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u043c"}),Object(o.jsx)("button",{onClick:this.props.closeModal,type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(o.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(o.jsx)("div",{className:"modal-body",children:Object(o.jsx)("div",{className:"container-fluid",children:Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)("div",{className:"col-md-8 react-crop-wrapper-row",children:Object(o.jsx)("div",{className:"react-crop-wrapper",children:i&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"item-option-list",children:[Object(o.jsx)(k,{actionFunction:function(){return e.props.upd("rotate",!r.options.rotate,c)},iconClass:"lni lni-ruler-alt",itemClass:"rotate",index:this.props.fileIndex}),Object(o.jsx)(k,{actionFunction:function(){return e.props.upd("rotate",!r.options.rotate,c)},iconClass:"lni lni-spinner-arrow",itemClass:"rotate",index:this.props.fileIndex})]}),Object(o.jsx)(C.a,{src:i,crop:n,ruleOfThirds:!0,onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange})]})})}),Object(o.jsx)("div",{className:"col-md-4 react-crop-options-bar",children:i&&Object(o.jsxs)("div",{className:"file-direction__crop",children:[Object(o.jsx)("span",{children:"\u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"}),Object(o.jsx)("img",{src:a,alt:""})]})})]})})}),Object(o.jsxs)("div",{className:"modal-footer",children:[Object(o.jsx)("button",{onClick:this.props.closeModal,type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),Object(o.jsx)("button",{onClick:this.save,type:"button",className:"btn btn-primary",children:"\u041e\u0431\u0440\u0435\u0437\u0430\u0442\u044c"})]})]})})})}}]),n}(i.PureComponent);function M(e,t){var n,i=e.files;switch(t.type){case"add":for(var a=t.payload,s=[],c=0;c<a.length;c++){var o={id:F(n=a[c]),file:n,body:"",options:{count:1,format:"10x15",paper:"\u043c\u0430\u0442\u043e\u0432\u0430\u044f",cadr:0,rotate:!1,changed:!0,cropped:[],aspect:10/15}};s.push(o)}return{files:e.files.concat(s)};case"remove":return i.splice(t.payload,1,null),{files:i};case"updateOptions":return i[t.payload.index].options=t.payload.options,{files:i};case"rotate":var r=i[t.payload].options.rotate;return i[t.payload].options.rotate=!r,{files:i};case"crop":return i[t.payload].options.cropped.push(i[t.payload].options.preCrop),{files:i};default:throw new Error}}function F(e){return e.size+"_"+e.name}var P=a.a.createContext(null);function D(){var e=Object(i.useReducer)(M,{files:[],changeMod:!1,setupImageMod:null,lastModifiedTime:(new Date).getTime()}),t=Object(d.a)(e,2),n=t[0],a=t[1];return Object(o.jsxs)(P.Provider,{value:{state:n,dispatch:a},children:[Object(o.jsx)(T,{}),"number"===typeof setupImageMod&&Object(o.jsx)(L,{fileIndex:n.setupImageMod,file:n.files[n.setupImageMod],closeModal:function(){},upd:function(e,t,n){}})]})}function T(e){var t=Object(i.useContext)(P),n=t.state,a=t.dispatch;return Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)("div",{className:"col-12 col-lg-10",children:Object(o.jsxs)("div",{className:"card border-secondary my-3",children:[Object(o.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:["\u0412\u0430\u0448\u0438 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438: ",n.files.length,Object(o.jsx)(E,{modOn:n.changeMod,setChangingMod:n.setChangingMod})]}),Object(o.jsx)("div",{className:"card-body",children:Object(o.jsxs)("div",{className:"image-list",children:[Object(o.jsxs)("label",{children:[Object(o.jsx)("span",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e"}),Object(o.jsx)("input",{onChange:function(e){a({type:"add",payload:e.target.files})},className:"form-control",type:"file",multiple:!0})]}),Object(o.jsx)(I,{})]})}),Object(o.jsx)("div",{className:"card-footer d-flex justify-content-end",children:Object(o.jsx)("div",{className:"btn btn-success disabled",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044e \u0437\u0430\u043a\u0430\u0437\u0430"})})]})}),Object(o.jsx)("div",{className:"col-12 col-lg-2",children:Object(o.jsx)(U,Object(l.a)({mod:!0,massSetOptions:n.massSetOptions},e))})]})}function E(e){var t="\u041c\u0430\u0441\u0441\u043e\u0432\u043e\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435";return e.modOn&&(t="\u0441\u043d\u044f\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435"),Object(o.jsx)("div",{onClick:e.setChangingMod,className:"btn btn-info text-white",children:t})}var W=function(){return Object(o.jsxs)("div",{className:"container",children:[Object(o.jsx)(r,{}),Object(o.jsx)(D,{})]})},H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),i(e),a(e),s(e),c(e)}))};c.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(W,{})}),document.getElementById("root")),H()}},[[38,1,2]]]);
//# sourceMappingURL=main.636034ee.chunk.js.map